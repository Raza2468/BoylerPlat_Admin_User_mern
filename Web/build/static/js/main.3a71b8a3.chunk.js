(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{63:function(e,t,n){},64:function(e,t,n){},99:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(17),s=n.n(a),l=(n(63),n(64),n(3));var o=function(){return Object(l.jsx)("div",{children:Object(l.jsx)("h1",{children:"Home"})})},i=n(40),j=n.n(i),u=n(53),d=n(28),b=n(12),h=n(107),O=n(8),x=n(11),p=n(19),m=n.n(p),f=function(){var e="http://localhost:3001",t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(c.useRef)(),a=Object(c.useRef)(),s=Object(c.useState)(""),o=Object(d.a)(s,2),i=o[0],p=o[1],f=Object(c.useState)(""),g=Object(d.a)(f,2),v=g[0],y=g[1],w=Object(c.useState)(!1),N=Object(d.a)(w,2),S=N[0],k=N[1];Object(O.g)();function L(){return(L=Object(u.a)(j.a.mark((function c(){return j.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(console.log(n.current.state.innerValue),""!==n.current.state.innerValue){c.next=5;break}return c.abrupt("return",p("email not found"));case 5:if(r.current.state.innerValue===a.current.state.innerValue){c.next=7;break}return c.abrupt("return",p("Password do not match"));case 7:try{y("Sign up succes full"),k(!0),m()({method:"post",url:e+"/auth/signup",data:{name:t.current.state.innerValue,email:n.current.state.innerValue,password:r.current.state.innerValue}}).then((function(e){e.data.status,alert(e.data.message)})).catch((function(e){console.log(e)}))}catch(s){p("Fail to craete an account")}k(!1);case 9:case"end":return c.stop()}}),c)})))).apply(this,arguments)}return Object(l.jsx)(b.d,{className:"singup_boader",children:Object(l.jsx)(b.i,{children:Object(l.jsx)(b.c,{md:"6",children:Object(l.jsxs)("form",{noValidate:!0,onSubmit:function(e){e.preventDefault(),function(){L.apply(this,arguments)}()},children:[Object(l.jsx)("h1",{className:"h1 text-center mb-4",children:"Sign up"}),i&&Object(l.jsx)(h.a,{variant:"danger",children:i}),v&&Object(l.jsx)(h.a,{variant:"success",children:v}),Object(l.jsxs)("div",{className:"grey-text",children:[Object(l.jsx)(b.f,{label:"Type your name",icon:"user",type:"text",ref:t,validate:!0}),Object(l.jsx)(b.f,{label:"Type your email",icon:"envelope",type:"email",ref:n}),Object(l.jsx)(b.f,{label:"Type your password",icon:"lock",type:"password",ref:r,validate:!0}),Object(l.jsx)(b.f,{label:"Type your RE-password",icon:"lock",type:"password",ref:a,validate:!0})]}),Object(l.jsxs)("div",{className:"text-center",children:[Object(l.jsx)(b.b,{disabled:S,type:"submit",children:"Sign up"}),Object(l.jsxs)("p",{children:["Alerady Have an account? ",Object(l.jsx)(x.b,{to:"./Login",children:"Log In"})," "]})]})]})})})})},g=n(16),v=r.a.createContext(),y=r.a.createContext(),w=function(){return Object(c.useContext)(v)},N=function(){return Object(c.useContext)(y)};function S(e){var t=e.children,n=Object(c.useState)({user:null,role:null,loginStatus:!1}),r=Object(d.a)(n,2),a=r[0],s=r[1];return Object(c.useEffect)((function(){m()({method:"get",url:"http://localhost:3001/getProfile",withCredentials:!0}).then((function(e){console.log("context response",e.data.profile,e.status),200===e.status&&(s((function(t){return Object(g.a)(Object(g.a)({},t),{},{user:e.data.profile,loginStatus:!0,role:e.data.profile.role})})),console.log("check",e.data.profile.role))})).catch((function(e){console.log(JSON.stringify("Error===========",e.response.status)),console.log(e),e.response&&200===e.response.status||s((function(e){return Object(g.a)(Object(g.a)({},e),{},{role:"loggedout"})}))}))}),[]),Object(l.jsx)(v.Provider,{value:a,children:Object(l.jsx)(y.Provider,{value:s,children:t})})}m.a.defaults.withCredentials=!0;var k=function(){w();var e=N();return Object(l.jsx)(b.d,{className:"singup_boader",children:Object(l.jsx)(b.i,{children:Object(l.jsx)(b.c,{md:"6",children:Object(l.jsxs)("form",{onSubmit:function(t){t.preventDefault(),m()({method:"post",url:"http://localhost:3001/auth/Login",data:{email:document.getElementById("email").value,password:document.getElementById("password").value},withCredentials:!0}).then((function(t){console.log("response.data: ",t.data),200===t.status?e((function(e){return Object(g.a)(Object(g.a)({},e),{},{user:t.data.user,role:t.data.user.role})})):alert(t.data.message)})).catch((function(e){console.log(e)}))},className:"formcenter",children:[Object(l.jsx)("p",{className:"h4 text-center mb-4",children:"Sign in"}),Object(l.jsx)("label",{htmlFor:"defaultFormLoginEmailEx",className:"grey-text",children:"Your email"}),Object(l.jsx)("input",{type:"email",id:"email",className:"form-control",placeholder:"Enter Your Email"}),Object(l.jsx)("br",{}),Object(l.jsx)("label",{htmlFor:"defaultFormLoginPasswordEx",className:"grey-text",children:"Your password"}),Object(l.jsx)("input",{type:"password",id:"password",className:"form-control",placeholder:"Enter Your Password"}),Object(l.jsx)("div",{className:"text-center mt-4",children:Object(l.jsx)(b.b,{color:"unique",type:"submit",children:"Login"})})]})})})})};function L(){return Object(l.jsx)("div",{children:Object(l.jsx)("h1",{children:"User Dashboard"})})}function E(){return Object(l.jsx)("div",{children:Object(l.jsx)("h1",{children:"Admin Dashboard"})})}var C=n(104);var F=function(){Object(O.g)();var e=N();return Object(l.jsx)(C.a,{variant:"danger",onClick:function(){m()({method:"post",url:"http://localhost:3001/auth/logout",withCredentials:!0}).then((function(t){200===t.status&&(alert(t.data.message),e((function(e){return Object(g.a)(Object(g.a)({},e),{},{loginStatus:!1,role:"loggedout",user:null})})))}),(function(e){console.log(e.message)}))},children:"Logout"})},V=n(106),D=n(105);var P=function(){var e=w();return console.log("globalState: ",e),Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("nav",{children:Object(l.jsxs)(V.a,{bg:"dark",variant:"dark",children:["admin"===e.role?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(D.a,{className:"mr-auto",children:Object(l.jsx)(D.a.Link,{children:Object(l.jsx)(x.b,{to:"/",children:"Admin Dashboard"})})}),Object(l.jsx)(F,{})]}):null,"user"===e.role?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)(D.a,{className:"mr-auto",children:Object(l.jsx)(D.a.Link,{children:Object(l.jsx)(x.b,{to:"/",children:"user Dashboard"})})}),Object(l.jsx)(F,{})]}):null,"loggedout"===e.role?Object(l.jsx)(l.Fragment,{children:Object(l.jsxs)(D.a,{className:"mr-auto",children:[Object(l.jsx)(D.a.Link,{children:Object(l.jsx)(x.b,{to:"/signup",children:"Signup"})}),Object(l.jsx)(D.a.Link,{children:Object(l.jsx)(x.b,{to:"/",children:"Home"})}),Object(l.jsx)(D.a.Link,{children:Object(l.jsx)(x.b,{to:"/login",children:"Login"})})]})}):null]})}),null===e.role?Object(l.jsx)(O.d,{children:Object(l.jsx)(O.b,{path:"*",children:Object(l.jsx)("h1",{children:"LOADING......"})})}):null,"loggedout"===e.role?Object(l.jsxs)(O.d,{children:[Object(l.jsx)(O.b,{exact:!0,path:"/",children:Object(l.jsx)(o,{})}),Object(l.jsx)(O.b,{path:"/signup",children:Object(l.jsx)(f,{})}),Object(l.jsx)(O.b,{path:"/login",children:Object(l.jsx)(k,{})}),Object(l.jsx)(O.b,{path:"*",children:Object(l.jsx)(O.a,{to:"/"})})]}):null,"user"===e.role?Object(l.jsxs)(O.d,{children:[Object(l.jsx)(O.b,{exact:!0,path:"/",children:Object(l.jsx)(L,{})}),Object(l.jsx)(O.b,{path:"*",children:Object(l.jsx)(O.a,{to:"/"})})]}):null,"admin"===e.role?Object(l.jsxs)(O.d,{children:[Object(l.jsx)(O.b,{exact:!0,path:"/",children:Object(l.jsx)(E,{})}),Object(l.jsx)(O.b,{path:"*",children:Object(l.jsx)(O.a,{to:"/"})})]}):null]})};s.a.render(Object(l.jsx)(r.a.StrictMode,{children:Object(l.jsx)(x.a,{children:Object(l.jsx)(S,{children:Object(l.jsx)(P,{})})})}),document.getElementById("root"))}},[[99,1,2]]]);
//# sourceMappingURL=main.3a71b8a3.chunk.js.map