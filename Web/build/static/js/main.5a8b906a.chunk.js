(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{100:function(e,t,c){},101:function(e,t,c){},162:function(e,t){},163:function(e,t){},170:function(e,t){},172:function(e,t){},206:function(e,t,c){"use strict";c.r(t);var n=c(1),a=c.n(n),r=c(20),s=c.n(r),l=(c(100),c(14)),o=(c(101),c(3));var i=function(){return Object(o.jsx)("div",{children:Object(o.jsx)("h1",{children:"Home"})})},j=c(62),u=c.n(j),d=c(48),b=c(90),h=c(26),O=c(12),x=c(214),m=c(11),p=c(16),f=c.n(p),g=(c(133),function(){var e="http://localhost:3001",t=Object(n.useRef)(),c=Object(n.useRef)(),a=Object(n.useRef)(),r=Object(n.useRef)(),s=Object(n.useState)(""),l=Object(h.a)(s,2),i=l[0],j=l[1],p=Object(n.useState)(""),g=Object(h.a)(p,2),v=g[0],y=g[1],w=Object(n.useState)(!1),S=Object(h.a)(w,2),N=S[0],k=S[1],E=Object(n.useState)(""),L=Object(h.a)(E,2),C=L[0],F=L[1],V=Object(n.useState)(""),D=Object(h.a)(V,2),P=D[0],I=D[1];function R(){return(R=Object(b.a)(u.a.mark((function n(){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log(c.current.state.innerValue),""!==c.current.state.innerValue){n.next=5;break}return n.abrupt("return",j("email not found"));case 5:if(a.current.state.innerValue===r.current.state.innerValue){n.next=7;break}return n.abrupt("return",j("Password do not match"));case 7:try{y("Sign up succes full"),k(!0),f()({method:"post",url:e+"/auth/signup",data:{name:t.current.state.innerValue,email:c.current.state.innerValue,password:a.current.state.innerValue}}).then((function(e){e.data.status,alert(e.data.message)})).catch((function(e){console.log(e)}))}catch(s){j("Fail to craete an account")}k(!1);case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(n.useEffect)((function(){f()({method:"post",url:e+"/auth/validateEmail",data:{email:C}}).then((function(e){null===e.data.data?I("email valid"):e.data.data&&I("email already registered")}))}),[C]),Object(o.jsx)(O.d,{className:"singup_boader",children:Object(o.jsx)(O.i,{children:Object(o.jsx)(O.c,{md:"6",children:Object(o.jsxs)("form",{noValidate:!0,onSubmit:function(e){e.preventDefault(),function(){R.apply(this,arguments)}()},children:[Object(o.jsx)("h1",{className:"h1 text-center mb-4",children:"Sign up"}),i&&Object(o.jsx)(x.a,{variant:"danger",children:i}),v&&Object(o.jsx)(x.a,{variant:"success",children:v}),Object(o.jsxs)("div",{className:"grey-text",children:[Object(o.jsx)(O.f,{label:"Type your name",icon:"user",type:"text",ref:t,validate:!0}),Object(o.jsxs)("div",{children:[Object(o.jsx)(O.f,{label:"Type your email",icon:"envelope",type:"email",ref:c,onChange:function(e){return F(e.target.value)}}),Object(o.jsx)("span",{class:"text-primary",children:P})]}),Object(o.jsx)(O.f,{label:"Type your password",icon:"lock",type:"password",ref:a,validate:!0}),Object(o.jsx)(O.f,{label:"Type your RE-password",icon:"lock",type:"password",ref:r,validate:!0}),Object(o.jsx)("br",{}),Object(o.jsx)(O.k,Object(d.a)({className:"text-muted"},"className","float-right")),Object(o.jsx)("br",{})]}),Object(o.jsxs)("div",{className:"text-center",children:[Object(o.jsx)(O.b,{disabled:N,type:"submit",children:"Sign up"}),Object(o.jsxs)("p",{children:["Alerady Have an account? ",Object(o.jsx)(m.b,{to:"./Login",children:"Log In"})," "]})]})]})})})})}),v=window.location.href.split(":"),y=v="https"===v[0]?"http://localhost:3001":"https://pro-mern-login.herokuapp.com";f.a.defaults.withCredentials=!0;var w=a.a.createContext(),S=a.a.createContext(),N=function(){return Object(n.useContext)(w)},k=function(){return Object(n.useContext)(S)};function E(e){var t=e.children,c=Object(n.useState)({user:null,loginStatus:!1,role:null}),a=Object(h.a)(c,2),r=a[0],s=a[1];return Object(n.useEffect)((function(){f()({method:"get",url:y+"/getProfile"}).then((function(e){s((function(t){return Object(l.a)(Object(l.a)({},t),{},{loginStatus:!0,user:e.data.profile,role:e.data.profile.role})}))})).catch((function(e){return s((function(e){return Object(l.a)(Object(l.a)({},e),{},{role:"loggedout"})})),console.log(e,"loggedout err")}))}),[]),Object(o.jsx)(w.Provider,{value:r,children:Object(o.jsx)(S.Provider,{value:s,children:t})})}f.a.defaults.withCredentials=!0;var L=function(){N();var e=k();return Object(o.jsx)(O.d,{className:"singup_boader",children:Object(o.jsx)(O.i,{children:Object(o.jsx)(O.c,{md:"6",children:Object(o.jsxs)("form",{onSubmit:function(t){t.preventDefault(),f()({method:"post",url:y+"/auth/Login",data:{email:document.getElementById("email").value,password:document.getElementById("password").value}}).then((function(t){console.log("response.data: ",t.data),200===t.status?(e((function(e){return Object(l.a)(Object(l.a)({},e),{},{user:t.data.user,role:t.data.user.role})})),alert(t.data.message,"success"),console.log("if,succ")):(console.log(t.data.message,"ELSW,succ"),alert(t.data.message,"else"))})).catch((function(e){console.log(e,"error email")}))},className:"formcenter",children:[Object(o.jsx)("p",{className:"h4 text-center mb-4",children:"Sign in"}),Object(o.jsx)("label",{htmlFor:"defaultFormLoginEmailEx",className:"grey-text",children:"Your email"}),Object(o.jsx)("input",{type:"email",id:"email",className:"form-control",placeholder:"Enter Your Email"}),Object(o.jsx)("br",{}),Object(o.jsx)("label",{htmlFor:"defaultFormLoginPasswordEx",className:"grey-text",children:"Your password"}),Object(o.jsx)("input",{type:"password",id:"password",className:"form-control",placeholder:"Enter Your Password"}),Object(o.jsx)("div",{className:"text-center mt-4",children:Object(o.jsx)(O.b,{color:"unique",type:"submit",children:"Login"})})]})})})})};function C(){return Object(o.jsx)("div",{children:Object(o.jsx)("h1",{children:"User Dashboard"})})}function F(){return Object(o.jsx)("div",{children:Object(o.jsx)("h1",{children:"Admin Dashboard"})})}var V=c(8),D=c(211);var P=function(){var e=k();return Object(o.jsx)(D.a,{variant:"danger",onClick:function(){f()({method:"post",url:"http://localhost:3001/auth/logout"}).then((function(t){200===t.status&&(alert(t.data.message),e((function(e){return Object(l.a)(Object(l.a)({},e),{},{loginStatus:!1,role:"loggedout",user:null})})))}),(function(e){console.log(e.message)}))},children:"Logout"})},I=c(213),R=c(212);var A=function(){var e=N();console.log("globalState: ",e);var t=k();return Object(n.useEffect)((function(){f()({method:"get",url:"http://localhost:3001/getProfile",withCredentials:!0}).then((function(e){console.log("response.data: ",e.data),t((function(t){return Object(l.a)(Object(l.a)({},t),{},{user:e.data.profile,role:e.data.profile.role})}))})).catch((function(e){console.log(e,"error email")}))}),[]),Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("nav",{children:Object(o.jsxs)(I.a,{bg:"dark",variant:"dark",children:["admin"===e.role?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(R.a,{className:"mr-auto",children:Object(o.jsx)(R.a.Link,{children:Object(o.jsx)(m.b,{to:"/",children:"Admin Dashboard"})})}),Object(o.jsx)(P,{})]}):null,"user"===e.role?Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(R.a,{className:"mr-auto",children:Object(o.jsx)(R.a.Link,{children:Object(o.jsx)(m.b,{to:"/",children:"user Dashboard"})})}),Object(o.jsx)(P,{})]}):null,"loggedout"===e.role?Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)(R.a,{className:"mr-auto",children:[Object(o.jsx)(R.a.Link,{children:Object(o.jsx)(m.b,{to:"/signup",children:"Signup"})}),Object(o.jsx)(R.a.Link,{children:Object(o.jsx)(m.b,{to:"/",children:"Home"})}),Object(o.jsx)(R.a.Link,{children:Object(o.jsx)(m.b,{to:"/login",children:"Login"})})]})}):null]})}),null===e.role?Object(o.jsx)(V.d,{children:Object(o.jsx)(V.b,{path:"*",children:Object(o.jsx)("h1",{children:"LOADING......"})})}):null,"loggedout"===e.role?Object(o.jsxs)(V.d,{children:[Object(o.jsx)(V.b,{exact:!0,path:"/",children:Object(o.jsx)(i,{})}),Object(o.jsx)(V.b,{path:"/signup",children:Object(o.jsx)(g,{})}),Object(o.jsx)(V.b,{path:"/login",children:Object(o.jsx)(L,{})}),Object(o.jsx)(V.b,{path:"*",children:Object(o.jsx)(V.a,{to:"/"})})]}):null,"user"===e.role?Object(o.jsxs)(V.d,{children:[Object(o.jsx)(V.b,{exact:!0,path:"/",children:Object(o.jsx)(C,{})}),Object(o.jsx)(V.b,{path:"*",children:Object(o.jsx)(V.a,{to:"/"})})]}):null,"admin"===e.role?Object(o.jsxs)(V.d,{children:[Object(o.jsx)(V.b,{exact:!0,path:"/",children:Object(o.jsx)(F,{})}),Object(o.jsx)(V.b,{path:"*",children:Object(o.jsx)(V.a,{to:"/"})})]}):null]})};s.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(m.a,{children:Object(o.jsx)(E,{children:Object(o.jsx)(A,{})})})}),document.getElementById("root"))}},[[206,1,2]]]);
//# sourceMappingURL=main.5a8b906a.chunk.js.map